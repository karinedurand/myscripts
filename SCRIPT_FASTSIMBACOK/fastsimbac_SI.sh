#!/bin/bash
module load bioinfo/fastsimbac-bd3ad13
for i in `cat listems`
do
while read line 
  do   t=`echo $line |cut -d" " -f2`
  r=`echo $line |cut -d" " -f3`
  delta=`echo $line |cut -d" " -f4`
  TS=`echo $line |cut -d" " -f5`
  N2=`echo $line |cut -d" " -f7`
  Na=`echo $line |cut -d" " -f8`
  TS2=`echo $line |cut -d" " -f9`
  echo   ./fastSimBac 30 1712736 -T -t $t -r $r $delta -n 1 1 -n 2 $N2 -I 2 13 17  -ej $TS 1 2   > line
    ./fastSimBac 30 1712736 -T -t $t -r $r $delta -I 2 13 17 -C "(((((7:0.00003,(9:0.00000,21:0.00003)0.800:0.00003)1.000:0.05142,18:0.12509)1.000:0.05768,((22:0.00000,24:0.00002)1.000:0.04387,(12:0.05809,(0:0.00005,2:0.00002)1.000:0.04365)0.990:0.01100)1.000:0.01581)0.000:0.00000,(27:0.00012,(13:0.00002,(10:0.00017,23:0.00017)0.280:0.00000)0.970:0.00010)1.000:0.04921)1.000:2.17941,((1:0.0,14:0.0,29:0.0):0.00000,19:0.00002)0.710:0.00002,(20:0.00000,((((4:0.00029,8:0.00000)1.000:0.00940,(5:0.00005,(6:0.00002,(15:0.0,28:0.0):0.00000)0.400:0.00000)1.000:0.00190)1.000:0.00247,(16:0.01394,(3:0.01180,(11:0.04918,(26:0.07508,17:0.02519)1.000:0.02444)1.000:0.01811)1.000:0.00598)1.000:0.01052)1.000:0.00874,25:0.00002)0.410:0.00000)0.800:0.00000);" -n 1 1 -n 2 $N2   -ej $TS 1 2   | ./msformatter >temp2 
if test -s temp2
then 
echo "temp2" >>log
cat  line temp2  >> $i.ms
else
cat line segsite >>  $i.ms
fi
done< $i
done